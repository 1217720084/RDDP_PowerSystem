# RDDP_PowerSystem
Robust Dual Dynamic Programming for solving real-time operation problems in power system.

The RDDP solves multi-stage minimax problems in the following form:

$\operatorname{minimize} \quad \boldsymbol{q}_{1}^{\top} \boldsymbol{x}_{1}+\mathcal{Q}_{2}\left(\boldsymbol{x}_{1}\right)$
subject to $\quad W_{1} x_{1} \geq h_{1}$
$$
x_{1} \in \mathbb{R}^{n_{1}}
$$

In which $\mathcal{Q}_{t}\left(\boldsymbol{x}_{t-1}\right)$ is called the stage $t$ worst-case cost-to-go function, defined as below:

$\mathcal{Q}_{t}\left(\boldsymbol{x}_{t-1}\right)\max \left\{Q_{t}\left(\boldsymbol{x}_{t-1} = \boldsymbol{\xi}_{t}\right): \boldsymbol{\xi}_{t} \in \boldsymbol{\Xi}_{t}\right\}$

$\begin{aligned}
Q_{t}\left(\boldsymbol{x}_{t-1} ; \boldsymbol{\xi}_{t}\right)=\left[\begin{array}{cc}
\operatorname{minimize} & \boldsymbol{q}_{t}^{\top} \boldsymbol{x}_{t}+\mathscr{Q}_{t+1}\left(\boldsymbol{x}_{t}\right) \\
\text { subject to } & \boldsymbol{T}_{t}\left(\boldsymbol{\xi}_{t}\right) \boldsymbol{x}_{t-1}+\boldsymbol{W}_{t} \boldsymbol{x}_{t} \geq \boldsymbol{h}_{t}\left(\boldsymbol{\xi}_{t}\right) \\
\boldsymbol{x}_{t} \in \mathbb{R}^{n_{t}}
\end{array}\right] \\
& t=2, \ldots, T
\end{aligned}$

The worst-case cost-to-go function can be bounded from above and from below.

1. **Upper Bound**

$\bar{Q}_{t}\left(x_{t-1}\right)$
$=\operatorname{maximize}\left[\begin{array}{cc}\operatorname{minimize} & \boldsymbol{q}_{t}^{\top} \boldsymbol{x}_{t}+\bar{\alpha}_{t+1}\left(\boldsymbol{x}_{t}\right) \\ \text { subject to } & \boldsymbol{T}_{t}\left(\boldsymbol{\xi}_{t}\right) \boldsymbol{x}_{t-1}+\boldsymbol{W}_{t} \boldsymbol{x}_{t} \geq \boldsymbol{h}_{t}\left(\boldsymbol{\xi}_{t}\right) \\ & \boldsymbol{x}_{t} \in \mathbb{R}^{n_{t}}\end{array}\right]$
subject to $\xi_{t} \in \Xi_{t}$

2. **Lower Bound**

$\underline{Q}_{t}\left(x_{t-1} ; \xi_{t}\right)=\left[\begin{array}{cl}
\operatorname{minimize} & \boldsymbol{q}_{t}^{\top} \boldsymbol{x}_{t}+\underline{Q}_{t+1}\left(\boldsymbol{x}_{t}\right) \\
\text { subject to } & \boldsymbol{T}_{t}\left(\boldsymbol{\xi}_{t}\right) \boldsymbol{x}_{t-1}+\boldsymbol{W}_{t} \boldsymbol{x}_{t} \geq \boldsymbol{h}_{t}\left(\boldsymbol{\xi}_{t}\right) \\
\boldsymbol{x}_{t} \in \mathbb{R}^{n_{t}}
\end{array}\right]$


A test for modifyed IEEE 5-bus system(two wind farms and two hydro-units are added).
--------------------------------------------------------------------------------
                      **RDDP_PS.jl (c) Shi Yunhui, 2020**

| UpperBound   | LowerBound   | Gap          | Time         | TotalSolves |
|--------------|--------------|--------------|--------------|-------------|
| 6972\.823125 | 6972\.823125 | 0            | 0\.213275909 | 912         |
| 1\.54E\+06   | 27741\.33494 | 0\.9820293   | 0\.60708189  | 2698        |
| 1\.54E\+06   | 38802\.60677 | 0\.974863862 | 0\.711971045 | 4484        |
| 1\.54E\+06   | 39926\.38448 | 0\.974135885 | 0\.82376194  | 6270        |
| 1\.54E\+06   | 58164\.90885 | 0\.962321058 | 0\.93231988  | 8056        |
| 1\.54E\+06   | 67788\.87576 | 0\.9560867   | 1\.041819096 | 9842        |
| 1\.52E\+06   | 348708\.6992 | 0\.771235735 | 1\.149935961 | 11628       |
| 1\.46E\+06   | 344001\.2766 | 0\.763811084 | 1\.261293888 | 13414       |
| 1\.46E\+06   | 389661\.8953 | 0\.732460816 | 1\.371891022 | 15200       |
| 1\.44E\+06   | 413897\.7221 | 0\.71198763  | 1\.489176035 | 16986       |
| 1\.13E\+06   | 407906\.1009 | 0\.639250882 | 1\.608989    | 18772       |
| 1\.11E\+06   | 413897\.7221 | 0\.627567468 | 1\.724719048 | 20558       |
| 853307\.3192 | 413897\.7221 | 0\.51494882  | 1\.838414907 | 22344       |
| 853307\.3192 | 423207\.296  | 0\.50403883  | 1\.959326029 | 24130       |
| 796909\.3646 | 416513\.0455 | 0\.477339502 | 2\.070245981 | 25916       |
| 796909\.3646 | 433855\.167  | 0\.455577778 | 2\.182825089 | 27702       |
| 796909\.3646 | 444769\.6588 | 0\.441881751 | 2\.303598881 | 29488       |
| 796909\.3646 | 476151\.4941 | 0\.402502323 | 2\.421597004 | 31274       |
| 777525\.8722 | 481174\.2761 | 0\.381146926 | 2\.55051589  | 33060       |
| 735741\.0439 | 476151\.4941 | 0\.352827332 | 2\.673579931 | 34846       |
| 735741\.0439 | 476286\.6467 | 0\.352643636 | 2\.796056986 | 36632       |
| 716357\.5515 | 493184\.4193 | 0\.311538744 | 2\.917768955 | 38418       |
| 694338\.1097 | 495317\.6884 | 0\.286633297 | 3\.040646076 | 40204       |
| 678282\.2466 | 495317\.6884 | 0\.269746937 | 3\.161889076 | 41990       |
| 669420\.3263 | 490496\.6349 | 0\.267281534 | 3\.2832129   | 43776       |
| 662602\.3088 | 502172\.7881 | 0\.242120377 | 3\.40999198  | 45562       |
| 662602\.3088 | 502172\.7881 | 0\.242120377 | 3\.535759926 | 47348       |
| 662602\.3088 | 502172\.7881 | 0\.242120377 | 3\.657339096 | 49134       |
| 626993\.2375 | 490542\.6927 | 0\.217626821 | 3\.786448956 | 50920       |
| 610012\.4443 | 502172\.7881 | 0\.176782715 | 3\.912113905 | 52706       |
| 598960\.907  | 502172\.7881 | 0\.161593382 | 4\.046303988 | 54492       |
| 591669\.9661 | 490542\.6927 | 0\.170918382 | 4\.172830105 | 56278       |
| 585331\.9979 | 502172\.7881 | 0\.142071867 | 4\.29982996  | 58064       |
| 575953\.7258 | 490542\.6927 | 0\.148294957 | 4\.427326918 | 59850       |
| 574702\.5698 | 502172\.7881 | 0\.126204032 | 4\.555527925 | 61636       |
| 574702\.5698 | 510892\.4431 | 0\.111031567 | 4\.788529873 | 63422       |
| 574702\.5698 | 510892\.4431 | 0\.111031567 | 4\.91604805  | 65208       |
| 574702\.5698 | 510892\.4431 | 0\.111031567 | 5\.047038078 | 66994       |
| 570875\.76   | 512784\.9391 | 0\.101757379 | 5\.175340891 | 68780       |
| 570875\.76   | 513022\.9069 | 0\.101340532 | 5\.301670074 | 70566       |
| 570875\.76   | 513022\.9069 | 0\.101340532 | 5\.431293011 | 72352       |
| 570875\.76   | 514970\.255  | 0\.097929373 | 5\.5604949   | 74138       |
| 557739\.1735 | 503500\.0652 | 0\.09724816  | 5\.6920259   | 75924       |
| 557052\.7518 | 515130\.1607 | 0\.075257848 | 5\.819770098 | 77710       |
| 557052\.7518 | 515130\.1607 | 0\.075257848 | 5\.945645094 | 79496       |
| 555714\.0615 | 515956\.0656 | 0\.07154398  | 6\.071425915 | 81282       |
| 555714\.0615 | 515956\.0656 | 0\.07154398  | 6\.198447943 | 83068       |
| 546583\.3432 | 504325\.9702 | 0\.077311857 | 6\.333615065 | 84854       |
| 544876\.6188 | 515956\.0656 | 0\.053077251 | 6\.461742878 | 86640       |
| 544876\.6188 | 516124\.7615 | 0\.052767647 | 6\.591902971 | 88426       |
| 544876\.6188 | 516124\.7615 | 0\.052767647 | 6\.724005938 | 90212       |
| 539465\.1547 | 516124\.7615 | 0\.043265803 | 6\.858711004 | 91998       |
| 539465\.1547 | 516124\.7615 | 0\.043265803 | 6\.988493919 | 93784       |
| 526400\.9628 | 516124\.7615 | 0\.019521623 | 7\.116355896 | 95570       |
| 525266\.3787 | 516124\.7615 | 0\.017403774 | 7\.25001502  | 97356       |
| 525266\.3787 | 516124\.7615 | 0\.017403774 | 7\.388587952 | 99142       |
| 525266\.3787 | 516124\.7615 | 0\.017403774 | 7\.525094032 | 100928      |
| 525266\.3787 | 516349\.0697 | 0\.016976737 | 7\.668155909 | 102714      |
| 525266\.3787 | 516349\.0697 | 0\.016976737 | 7\.801615    | 104500      |
| 525266\.3787 | 516447\.7495 | 0\.01678887  | 7\.934638977 | 106286      |
| 525266\.3787 | 518780\.9409 | 0\.01234695  | 8\.074858904 | 108072      |
| 525266\.3787 | 519803\.3563 | 0\.01040048  | 8\.209629059 | 109858      |
| 525266\.3787 | 519803\.3563 | 0\.01040048  | 8\.337789059 | 111644      |
| 525266\.3787 | 519803\.3563 | 0\.01040048  | 8\.47249198  | 113430      |
| 525266\.3787 | 520185\.9949 | 0\.009672014 | 8\.607976913 | 115216      |

Converged. 65 iterations in 8.607977 seconds.
